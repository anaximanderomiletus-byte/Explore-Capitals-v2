import{j as e}from"./vendor-motion-CUvbj6jv.js";import{d as B,u as F,r as s}from"./vendor-react-CJteECPR.js";import{b as G,u as $,B as g}from"./index-MzODL-0A.js";import{C as q,ad as W,f as R,q as Y,o as Z,V as K,I as H}from"./vendor-icons-DnoOvNGG.js";import"./vendor-firebase-BmNGKg-n.js";const te=()=>{const{verifyEmailCode:u,confirmResetPassword:p,user:x}=G(),{setPageLoading:I,setNavbarMode:j}=$(),o=B(),y=F(),[f,T]=s.useState(null),[N,U]=s.useState(null),[m,l]=s.useState("loading"),[w,c]=s.useState(null),[h,A]=s.useState(!1),k=s.useRef(!1),[t,z]=s.useState(""),[v,L]=s.useState(""),[S,E]=s.useState(!1),i=s.useMemo(()=>({length:t.length>=8&&t.length<=4096,uppercase:/[A-Z]/.test(t),lowercase:/[a-z]/.test(t),number:/[0-9]/.test(t),special:/[!@#$%^&*(),.?":{}|<>]/.test(t)}),[t]),O=s.useMemo(()=>Object.values(i).every(Boolean),[i]);s.useEffect(()=>{I(!1),j("hero");const a=(()=>{const P=new URLSearchParams(y.search);if(P.get("oobCode"))return P;const V=window.location.hash,C=new URLSearchParams(V.split("?")[1]||"");return C.get("oobCode")?C:new URLSearchParams(window.location.search)})(),n=a.get("mode"),b=a.get("oobCode");if(T(n),U(b),!n||!b){l("error"),c("Invalid action link. Please request a new one.");return}if(n==="verifyEmail"&&!k.current){if(x?.emailVerified){l("success");return}k.current=!0,setTimeout(()=>M(b),500)}else n==="resetPassword"?l("loading"):n!=="verifyEmail"&&(l("error"),c("Unsupported action mode."));return()=>j("default")},[y]);const M=async r=>{try{await u(r),x&&await x.reload(),l("success");const a=setTimeout(()=>{x?o("/profile",{replace:!0}):o("/auth",{replace:!0})},4e3);return()=>clearTimeout(a)}catch(a){console.error("Email verification error:",a),l("error"),c(a?.message??"Failed to verify email. The link may be expired.")}},D=async r=>{if(r.preventDefault(),!!N){if(t!==v){c("Passwords do not match.");return}E(!0),c(null);try{await p(N,t),l("success"),setTimeout(()=>o("/auth"),3e3)}catch(a){c(a?.message??"Failed to reset password.")}finally{E(!1)}}};return e.jsxs("div",{className:"min-h-screen bg-surface-dark flex flex-col relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 z-0",children:[e.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[100%] h-[100%] bg-sky/30 rounded-full blur-[150px] animate-pulse-slow opacity-80"}),e.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[80%] h-[80%] bg-sky/15 rounded-full blur-[120px] animate-pulse-slow opacity-50"})]}),e.jsx("div",{className:"relative z-10 flex-grow flex items-center justify-center px-6 py-24",children:e.jsx("div",{className:"w-full max-w-[600px] bg-white/20 backdrop-blur-3xl rounded-[4rem] border-2 border-white/40 overflow-hidden relative",children:e.jsxs("div",{className:"p-10 sm:p-16 text-center",children:[e.jsxs("div",{className:"inline-flex items-center gap-3 px-5 py-2 bg-white/30 rounded-full text-[10px] font-black uppercase tracking-[0.4em] text-white mb-10 border-2 border-white/40",children:[e.jsx(q,{size:14,className:"animate-spin-slow text-sky-light"}),e.jsx("span",{children:"SECURITY PORTAL"})]}),m==="loading"&&f==="verifyEmail"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"w-20 h-20 bg-sky/20 rounded-full flex items-center justify-center text-sky mx-auto animate-pulse",children:e.jsx(W,{size:40})}),e.jsx("h2",{className:"text-3xl font-black text-white uppercase tracking-tighter",children:"Verifying..."})]}),m==="loading"&&f==="resetPassword"&&e.jsxs("form",{className:"space-y-8 text-left",onSubmit:D,children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-black text-white uppercase tracking-tighter",children:"New Password"}),e.jsx("p",{className:"text-[10px] text-white/40 font-black uppercase tracking-widest mt-2",children:"Enter your new secure password"})]}),w&&e.jsx("div",{className:"bg-red-500/20 p-4 rounded-2xl border border-red-500/30 text-red-500 text-[10px] font-black uppercase tracking-widest mb-6",children:w}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[9px] font-black uppercase tracking-widest text-white/30 ml-1",children:"Password"}),e.jsxs("div",{className:"relative group",children:[e.jsx(R,{className:"absolute left-5 top-1/2 -translate-y-1/2 text-white/20 group-focus-within:text-sky transition-colors",size:18}),e.jsx("input",{type:h?"text":"password",value:t,onChange:r=>z(r.target.value),className:"w-full bg-white/5 border border-white/20 rounded-2xl pl-14 pr-12 py-4 focus:border-sky/50 outline-none text-white font-black text-sm transition-all",placeholder:"••••••••"}),e.jsx("button",{type:"button",onClick:()=>A(!h),className:"absolute right-4 top-1/2 -translate-y-1/2 text-white/20 hover:text-sky transition-colors",tabIndex:-1,children:h?e.jsx(Y,{size:18}):e.jsx(Z,{size:18})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[9px] font-black uppercase tracking-widest text-white/30 ml-1",children:"Confirm"}),e.jsxs("div",{className:"relative group",children:[e.jsx(R,{className:"absolute left-5 top-1/2 -translate-y-1/2 text-white/20 group-focus-within:text-sky transition-colors",size:18}),e.jsx("input",{type:h?"text":"password",value:v,onChange:r=>L(r.target.value),className:"w-full bg-white/5 border border-white/20 rounded-2xl pl-14 pr-12 py-4 focus:border-sky/50 outline-none text-white font-black text-sm transition-all",placeholder:"••••••••"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-4 px-1",children:[e.jsx(d,{met:i.length,label:"8-4096 characters"}),e.jsx(d,{met:i.uppercase,label:"Uppercase (A-Z)"}),e.jsx(d,{met:i.lowercase,label:"Lowercase (a-z)"}),e.jsx(d,{met:i.number,label:"Numeric (0-9)"}),e.jsx(d,{met:i.special,label:"Special char (!@#$)"})]}),e.jsx(g,{type:"submit",disabled:S||!O,className:"w-full h-16 mt-6 uppercase tracking-widest font-black",children:S?"UPDATING...":"RESET PASSWORD"})]}),m==="success"&&e.jsxs("div",{className:"space-y-6 text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-green-500/20 rounded-full flex items-center justify-center text-green-500 mx-auto",children:e.jsx(K,{size:48})}),e.jsx("h2",{className:"text-3xl font-black text-white uppercase tracking-tighter",children:"SUCCESS!"}),e.jsxs("p",{className:"text-[10px] text-white/40 font-black uppercase tracking-widest leading-relaxed",children:[f==="verifyEmail"?"YOUR EMAIL IS VERIFIED.":"PASSWORD RESET SUCCESSFUL.",e.jsx("br",{}),"REDIRECTING TO SIGN IN..."]}),e.jsx(g,{onClick:()=>o("/auth"),className:"w-full h-14 mt-4 uppercase tracking-widest font-black",children:"SIGN IN NOW"})]}),m==="error"&&e.jsxs("div",{className:"space-y-6 text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-red-500/20 rounded-full flex items-center justify-center text-red-500 mx-auto",children:e.jsx(H,{size:48})}),e.jsx("h2",{className:"text-3xl font-black text-white uppercase tracking-tighter",children:"ERROR"}),e.jsx("p",{className:"text-[10px] text-white/40 font-black uppercase tracking-widest leading-relaxed max-w-[250px] mx-auto",children:w}),e.jsx(g,{onClick:()=>o("/auth"),className:"w-full h-14 mt-4 uppercase tracking-widest font-black",children:"BACK TO SAFETY"})]})]})})})]})},d=({met:u,label:p})=>e.jsxs("div",{className:`flex items-center gap-1.5 transition-colors duration-300 ${u?"text-green-400":"text-white/20"}`,children:[e.jsx("div",{className:`w-1 h-1 rounded-full ${u?"bg-green-400":"bg-white/20"}`}),e.jsx("span",{className:"text-[8px] font-black uppercase tracking-widest leading-none text-left",children:p})]});export{te as default};
