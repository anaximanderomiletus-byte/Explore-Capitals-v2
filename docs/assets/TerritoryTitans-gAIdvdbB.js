import{r,k as K,a as q,u as Q,T as W,D,j as e,S as g,b as w,l as H,m as y,L as _,n as R}from"./index-XWDUNfDH.js";import{u as Y}from"./useGameLimit-OUV4Kamb.js";import{F as J}from"./FeedbackOverlay-Cq1ahV5C.js";import{L as V}from"./lock-CvyT1Z25.js";import{C as I}from"./subscription-DHmQVy4C.js";import{A as h}from"./arrow-left-BYcrqben.js";import{G as X}from"./globe-DLhJO6Ik.js";import{P as Z}from"./play-BgS6ayBy.js";import{T as ee}from"./timer-B3gZtB4h.js";import"./star-B3fTSqnJ.js";import"./sparkles--g8jpY2H.js";import"./circle-check-hYOQbUwt.js";import"./circle-x-D8W6zfzV.js";const $=n=>[...n].sort(()=>Math.random()-.5),te=n=>Array.from(n).map(u=>String.fromCharCode(u.codePointAt(0)-127397).toLowerCase()).join("");function he(){const[n,u]=r.useState("start"),[p,j]=r.useState(0),[o,v]=r.useState(60),[a,F]=r.useState(null),[f,k]=r.useState(null),[N,b]=r.useState(null),[O,T]=r.useState(0),[S,z]=r.useState(!1),{recordGameResult:C}=K(),{isPremium:A}=Y(),x=q(),{setPageLoading:M}=Q(),d=r.useMemo(()=>[...W,...D].map(t=>({...t,sovereignty:t.sovereignty||"Limited Recognition"})),[]),P=r.useMemo(()=>{const t=new Set(d.map(s=>s.sovereignty));return Array.from(t)},[d]),L=r.useMemo(()=>{const t=new Set(d.map(s=>s.capital));return Array.from(t)},[d]);r.useEffect(()=>{M(!1)},[M]),r.useEffect(()=>{let t;return n==="playing"&&o>0?t=setInterval(()=>{v(s=>s-1)},1e3):o===0&&u("finished"),()=>clearInterval(t)},[n,o]),r.useEffect(()=>{n==="finished"&&!S&&(C({gameId:"territory-titans",score:p,durationSeconds:60-o}),z(!0))},[n,S,C,p,o]);const U=t=>{const s=Math.floor(t/60),l=t%60;return`${s}:${String(l).padStart(2,"0")}`},G=r.useCallback(()=>{k(null),b(null);const t=d[Math.floor(Math.random()*d.length)],s=Math.random()>.5?"sovereignty":"capital";let l,i;if(s==="sovereignty"){i=t.sovereignty;const m=P.filter(c=>c!==i).sort(()=>Math.random()-.5).slice(0,3);l=$([i,...m])}else{i=t.capital;const m=L.filter(c=>c!==i).sort(()=>Math.random()-.5).slice(0,3);l=$([i,...m])}F({territory:t,options:l,type:s})},[d,P,L]),E=()=>{if(!A){x("/premium");return}j(0),v(60),z(!1),b(null),T(0),G(),u("playing")},B=t=>{if(f||!a)return;k(t);const s=a.type==="sovereignty"?a.territory.sovereignty:a.territory.capital,l=t===s;b(l?"correct":"incorrect"),T(i=>i+1),l&&j(i=>i+10),setTimeout(G,800)};return!A&&n==="start"?e.jsxs("div",{className:"h-[100dvh] min-h-screen bg-surface-dark font-sans relative overflow-hidden flex items-center justify-center px-4",children:[e.jsx(g,{title:"Territory Titans - Premium Game",description:"Master autonomous regions and dependencies worldwide. A premium geography game."}),e.jsxs("div",{className:"fixed inset-0 z-0 pointer-events-none",children:[e.jsx("div",{className:"absolute top-[-20%] left-[-10%] w-[100%] h-[100%] bg-amber-500/10 rounded-full blur-[150px] opacity-60"}),e.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[80%] h-[80%] bg-amber-600/10 rounded-full blur-[120px] opacity-40"})]}),e.jsxs("div",{className:"max-w-md w-full bg-white/10 backdrop-blur-3xl rounded-3xl p-8 text-center border-2 border-amber-500/30 relative z-10",children:[e.jsx("div",{className:"w-20 h-20 bg-amber-500/20 rounded-2xl flex items-center justify-center mx-auto mb-8 border border-amber-500/30",children:e.jsx(V,{size:36,className:"text-amber-400"})}),e.jsx("h1",{className:"text-4xl font-display font-black text-white mb-2 uppercase tracking-tighter",children:"Territory Titans"}),e.jsx("p",{className:"text-amber-400 text-xs mb-6 font-bold uppercase tracking-[0.2em]",children:"Premium Game"}),e.jsx("p",{className:"text-white/60 text-sm mb-8",children:"Unlock this game and 3 more with Premium membership."}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs(w,{onClick:()=>x("/premium"),className:"w-full h-14 bg-gradient-to-r from-amber-500 to-amber-600 border-0",children:[e.jsx(I,{size:18})," UNLOCK WITH PREMIUM"]}),e.jsxs("button",{onClick:()=>x("/games"),className:"inline-flex items-center justify-center gap-2 text-white/30 hover:text-white transition-all font-black uppercase tracking-[0.3em] text-[10px] group",children:[e.jsx(h,{size:14,className:"group-hover:-translate-x-1 transition-transform"}),"Back to Games"]})]})]})]}):e.jsx("div",{className:"h-[100dvh] min-h-screen bg-surface-dark font-sans relative overflow-hidden",children:e.jsxs(H,{mode:"wait",children:[n==="start"&&e.jsxs(y.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:1.1},className:"h-full flex items-center justify-center px-4",children:[e.jsx(g,{title:"Territory Titans - Premium Game",description:"Master autonomous regions and dependencies worldwide. A premium geography game."}),e.jsxs("div",{className:"fixed inset-0 z-0 pointer-events-none",children:[e.jsx("div",{className:"absolute top-[-20%] left-[-10%] w-[100%] h-[100%] bg-accent/20 rounded-full blur-[150px] opacity-60"}),e.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[80%] h-[80%] bg-amber-500/10 rounded-full blur-[120px] opacity-40"})]}),e.jsxs("div",{className:"max-w-md w-full bg-white/10 backdrop-blur-3xl rounded-3xl p-8 text-center border-2 border-white/20 relative z-10",children:[e.jsxs("div",{className:"absolute top-4 right-4 px-3 py-1 bg-amber-500/20 rounded-full text-[9px] font-black text-amber-400 uppercase tracking-wider flex items-center gap-1",children:[e.jsx(I,{size:10})," Premium"]}),e.jsx("div",{className:"w-20 h-20 bg-accent/20 rounded-2xl flex items-center justify-center mx-auto mb-8 text-accent border border-white/30",children:e.jsx(X,{size:36})}),e.jsx("h1",{className:"text-4xl font-display font-black text-white mb-2 uppercase tracking-tighter",children:"Territory Titans"}),e.jsx("p",{className:"text-white/40 text-[10px] mb-10 font-bold uppercase tracking-[0.2em]",children:"Master territories & dependencies."}),e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs(w,{onClick:E,size:"md",className:"w-full h-16 text-xl uppercase tracking-widest font-black",children:["PLAY ",e.jsx(Z,{size:20,fill:"currentColor"})]}),e.jsxs("button",{onClick:()=>x("/games"),className:"inline-flex items-center justify-center gap-2 text-white/30 hover:text-white transition-all font-black uppercase tracking-[0.3em] text-[10px] group",children:[e.jsx(h,{size:14,className:"group-hover:-translate-x-1 transition-transform"}),"Back to Games"]})]})]})]},"start"),n==="playing"&&a&&e.jsxs(y.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,y:-20},className:"h-full flex flex-col px-3 md:px-4 pt-20 pb-4 md:pb-6 overflow-hidden",children:[e.jsx(g,{title:"Territory Titans - Playing",description:"Test your knowledge of world territories and dependencies."}),e.jsxs("div",{className:"fixed inset-0 z-0 pointer-events-none",children:[e.jsx("div",{className:"absolute top-[10%] right-[10%] w-[60%] h-[60%] bg-accent/10 rounded-full blur-[100px]"}),e.jsx("div",{className:"absolute bottom-[10%] left-[10%] w-[50%] h-[50%] bg-amber-500/5 rounded-full blur-[80px]"})]}),e.jsxs("div",{className:"max-w-3xl mx-auto w-full flex shrink-0 items-center gap-2 mb-3 md:mb-4 bg-white/10 backdrop-blur-2xl p-2.5 md:p-3 rounded-2xl border border-white/20 z-10",children:[e.jsx(_,{to:"/games",className:"p-2 bg-white/10 hover:bg-white/20 rounded-xl text-white/60 hover:text-white transition-all border border-white/10 shrink-0",children:e.jsx(h,{size:18})}),e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center min-w-0",children:[e.jsx("h1",{className:"text-[9px] sm:text-[10px] font-black text-white uppercase tracking-[0.15em] sm:tracking-[0.3em] truncate",children:"Territory Titans"}),e.jsx("div",{className:"h-0.5 w-6 bg-accent/40 rounded-full mt-1"})]}),e.jsx("div",{className:"w-[42px] shrink-0"})]}),e.jsxs("div",{className:"flex-1 max-w-3xl mx-auto w-full flex flex-col min-h-0 bg-white/10 backdrop-blur-3xl rounded-2xl md:rounded-3xl border border-white/20 overflow-hidden relative z-10 p-4 md:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-4 relative z-20 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-xl bg-warning/20 border border-warning/40",children:[e.jsx(R,{size:16,className:"text-warning"}),e.jsx("span",{className:"font-display font-black text-lg text-white tabular-nums",children:p})]}),e.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-xl transition-all ${o<10?"bg-red-500/10 border-2 border-error animate-timer-panic":"bg-sky/25 border border-white/30"}`,children:[e.jsx(ee,{size:16,className:o<10?"text-error":"text-sky-light"}),e.jsx("span",{className:`font-display font-black text-lg tabular-nums ${o<10?"text-error":"text-white"}`,children:U(o)})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center",children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("div",{className:"w-24 h-16 mx-auto mb-4 rounded-lg overflow-hidden bg-white/10 flex items-center justify-center",children:e.jsx("img",{src:`https://flagcdn.com/w160/${te(a.territory.flag)}.png`,alt:`${a.territory.name} flag`,className:"w-full h-full object-contain"})}),e.jsx("h2",{className:"text-2xl md:text-3xl font-display font-black text-white uppercase tracking-tight mb-2",children:a.territory.name}),e.jsx("p",{className:"text-sky-light text-xs font-bold uppercase tracking-[0.2em]",children:a.type==="sovereignty"?"Who has sovereignty over this territory?":"What is the capital?"})]}),e.jsx("div",{className:"w-full max-w-lg grid grid-cols-1 sm:grid-cols-2 gap-3",children:a.options.map((t,s)=>{const l=a.type==="sovereignty"?a.territory.sovereignty:a.territory.capital,i=t===l,m=f===t;let c="bg-white/10 border-white/20 hover:bg-white/20 text-white";return N&&(i?c="bg-accent/60 border-accent text-white":m?c="bg-red-500/60 border-red-500 text-white":c="bg-white/5 border-white/10 text-white/30"),e.jsx("button",{onClick:()=>B(t),disabled:!!f,className:`p-4 rounded-xl border-2 font-bold text-sm uppercase tracking-wide transition-all ${c} ${m&&!i?"animate-shake":""}`,children:t},s)})})]})]}),e.jsx(J,{type:N,triggerKey:O})]},"playing"),n==="finished"&&e.jsx(y.div,{initial:{opacity:0,scale:1.1},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"h-full flex items-center justify-center px-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white/10 backdrop-blur-3xl rounded-3xl p-10 text-center border-2 border-white/20 relative z-10",children:[e.jsx("div",{className:"w-20 h-20 bg-warning/20 rounded-full flex items-center justify-center mx-auto mb-8 text-warning border border-white/30",children:e.jsx(R,{size:36})}),e.jsx("h1",{className:"text-3xl font-display font-black text-white mb-1 uppercase tracking-tighter",children:"Finished"}),e.jsx("p",{className:"text-white/40 mb-6 text-[10px] font-bold uppercase tracking-[0.2em]",children:"Final Score"}),e.jsx("div",{className:"text-7xl font-display font-black text-white mb-10 tabular-nums",children:p}),e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx(w,{onClick:E,size:"md",className:"w-full h-16 text-xl uppercase tracking-widest font-black",children:"Play Again"}),e.jsxs("button",{onClick:()=>x("/games"),className:"inline-flex items-center justify-center gap-2 text-white/30 hover:text-white transition-all font-black uppercase tracking-[0.3em] text-[10px] group",children:[e.jsx(h,{size:14,className:"group-hover:-translate-x-1 transition-transform"}),"Back to Games"]})]})]})},"finished")]})})}export{he as default};
