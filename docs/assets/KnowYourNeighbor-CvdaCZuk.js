import{r as a,h as V,a as W,u as q,M as T,j as e,i as O,m as f,S as K,B as k,L as J,k as P}from"./index-B5zWe7ld.js";import{F as Q}from"./FeedbackOverlay-DLGFEcHD.js";import{N as X}from"./network-nMro2IN8.js";import{P as Z}from"./play-Cq6dKhmV.js";import{A as y}from"./arrow-left-DDk2YJBo.js";import{T as ee}from"./timer-CtX2DD3C.js";import"./sparkles-DbEpUizh.js";import"./circle-check-Bn5QiDpU.js";import"./circle-x-CF7cj6il.js";const F=l=>[...l].sort(()=>Math.random()-.5),te=l=>Array.from(l).map(m=>String.fromCharCode(m.codePointAt(0)-127397).toLowerCase()).join("");function me(){const[l,m]=a.useState("start"),[x,N]=a.useState(0),[n,z]=a.useState(60),[b,I]=a.useState([]),[o,M]=a.useState(null),[G,Y]=a.useState([]),[g,S]=a.useState([]),[d,h]=a.useState(null),[B,w]=a.useState(0),[D,v]=a.useState(null),[C,L]=a.useState(!1),{recordGameResult:$}=V(),A=W(),{setPageLoading:E}=q();a.useEffect(()=>{E(!1)},[E]),a.useEffect(()=>{const t=T.filter(s=>s.borders&&s.borders.length>0);I(t)},[]),a.useEffect(()=>{let t;return l==="playing"&&n>0?t=setInterval(()=>{z(s=>s-1)},1e3):n===0&&m("finished"),()=>clearInterval(t)},[l,n]),a.useEffect(()=>{l==="finished"&&!C&&($({gameId:"know-your-neighbor",score:x,durationSeconds:60-n}),L(!0))},[l,C,$,x,n]);const _=t=>{const s=Math.floor(t/60),i=t%60;return`${s}:${String(i).padStart(2,"0")}`},j=()=>{if(b.length===0)return;const t=b[Math.floor(Math.random()*b.length)];M(t),S([]),h(null),v(null);const s=t.borders||[],i=T.filter(u=>u.name!==t.name&&!s.includes(u.name)).map(u=>u.name),c=F(i),r=Math.max(4,15-s.length),p=c.slice(0,r);Y(F([...s,...p]))},R=()=>{N(0),z(60),L(!1),h(null),w(0),j(),m("playing")},H=t=>{d||S(s=>s.includes(t)?s.filter(i=>i!==t):[...s,t])},U=()=>{if(!o||!o.borders)return;const t=o.borders,s=g,i=t.filter(r=>!s.includes(r)),c=s.filter(r=>!t.includes(r));i.length===0&&c.length===0?(N(r=>r+20),h("correct"),w(r=>r+1),v("Perfect!"),setTimeout(j,700)):(h("incorrect"),w(r=>r+1),v(`${i.length} missed, ${c.length} wrong.`),setTimeout(j,2500))};return e.jsx("div",{className:"h-[100dvh] min-h-screen bg-surface-dark font-sans relative overflow-hidden",children:e.jsxs(O,{mode:"wait",children:[l==="start"&&e.jsxs(f.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:1.1},className:"h-full flex items-center justify-center px-4",children:[e.jsx(K,{title:"Know Your Neighbor",description:"Identify all the bordering countries."}),e.jsxs("div",{className:"fixed inset-0 z-0 pointer-events-none",children:[e.jsx("div",{className:"absolute top-[-20%] left-[-10%] w-[100%] h-[100%] bg-sky/20 rounded-full blur-[150px] opacity-60 animate-pulse-slow"}),e.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[80%] h-[80%] bg-accent/10 rounded-full blur-[120px] opacity-40 animate-pulse-slow"})]}),e.jsxs("div",{className:"max-w-md w-full bg-white/10 backdrop-blur-3xl rounded-3xl p-8 text-center border-2 border-white/20 relative z-10 overflow-hidden",children:[e.jsx("div",{className:"w-20 h-20 bg-sky/20 rounded-2xl flex items-center justify-center mx-auto mb-8 text-sky border border-white/30 relative overflow-hidden",children:e.jsx(X,{size:36,className:"relative z-10"})}),e.jsx("h1",{className:"text-4xl font-display font-black text-white mb-2 uppercase tracking-tighter drop-shadow-md",children:"Know Your Neighbor"}),e.jsx("p",{className:"text-white/40 text-[10px] mb-10 font-bold uppercase tracking-[0.2em] leading-relaxed",children:"Identify every bordering country."}),e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs(k,{onClick:R,size:"md",className:"w-full h-16 text-xl uppercase tracking-widest font-black",children:["PLAY ",e.jsx(Z,{size:20,fill:"currentColor"})]}),e.jsxs("button",{onClick:()=>A("/games"),className:"inline-flex items-center justify-center gap-2 text-white/30 hover:text-white transition-all font-black uppercase tracking-[0.3em] text-[10px] group relative z-20 pointer-events-auto",children:[e.jsx(y,{size:14,className:"group-hover:-translate-x-1 transition-transform"}),"Back to Games"]})]})]})]},"start"),l==="playing"&&o&&e.jsxs(f.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,y:-20},className:"h-full flex flex-col px-3 md:px-4 pt-16 pb-2 md:pb-3 overflow-hidden",children:[e.jsx(K,{title:"Playing Know Your Neighbor",description:"Select all the bordering countries."}),e.jsxs("div",{className:"fixed inset-0 z-0 pointer-events-none",children:[e.jsx("div",{className:"absolute top-[10%] right-[10%] w-[60%] h-[60%] bg-sky/10 rounded-full blur-[100px]"}),e.jsx("div",{className:"absolute bottom-[10%] left-[10%] w-[50%] h-[50%] bg-accent/5 rounded-full blur-[80px]"})]}),e.jsxs("div",{className:"max-w-2xl mx-auto w-full flex shrink-0 items-center gap-2 mb-2 md:mb-2 bg-white/10 backdrop-blur-2xl p-2 md:p-2.5 rounded-2xl border border-white/20 z-10",children:[e.jsx(J,{to:"/games",className:"p-2 bg-white/10 hover:bg-white/20 rounded-xl text-white/60 hover:text-white transition-all duration-75 border border-white/10 group shadow-inner shrink-0",children:e.jsx(y,{size:18,className:"transition-transform"})}),e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center min-w-0",children:[e.jsx("h1",{className:"text-[8px] sm:text-[9px] md:text-[10px] font-black text-white uppercase tracking-[0.1em] sm:tracking-[0.15em] md:tracking-[0.3em] drop-shadow-md truncate max-w-full text-center",children:"Know Your Neighbor"}),e.jsx("div",{className:"h-0.5 w-6 bg-sky/40 rounded-full mt-1"})]}),e.jsx("div",{className:"w-[42px] shrink-0"})]}),e.jsxs("div",{className:"flex-1 max-w-2xl mx-auto w-full flex flex-col min-h-0 bg-white/10 backdrop-blur-3xl rounded-2xl md:rounded-3xl border border-white/20 p-2 md:p-4 overflow-hidden relative z-10",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-1 sm:mb-2 md:mb-2 relative z-20 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 px-2 sm:px-2.5 py-1 md:px-3 md:py-1.5 rounded-xl shadow-inner bg-warning/20 border border-warning/40 relative shrink-0",children:[e.jsx(P,{size:14,className:"sm:w-4 sm:h-4 md:w-[18px] md:h-[18px] text-warning drop-shadow-md relative z-10"}),e.jsx("span",{className:"font-display font-black text-base sm:text-lg md:text-xl text-white tabular-nums drop-shadow-sm relative z-10",children:x})]}),e.jsxs("div",{className:`flex items-center gap-1.5 sm:gap-2 px-2 sm:px-2.5 py-1 md:px-3 md:py-1.5 rounded-xl shadow-inner transition-all duration-300 relative shrink-0 ${n<10?"bg-red-500/10 border-2 border-error animate-timer-panic":"bg-sky/25 text-white border border-white/30"}`,children:[e.jsx("div",{className:`relative z-10 ${n<10?"text-error":"text-sky-light"}`,children:e.jsx(ee,{size:14,className:"sm:w-4 sm:h-4 md:w-[18px] md:h-[18px]"})}),e.jsx("span",{className:`font-display font-black text-base sm:text-lg md:text-xl tabular-nums min-w-[28px] sm:min-w-[32px] md:min-w-[36px] relative z-10 drop-shadow-sm ${n<10?"text-error":"text-white"}`,children:_(n)})]})]}),e.jsx(O,{mode:"wait",children:e.jsxs(f.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},className:"h-full flex flex-col justify-between relative z-10",children:[e.jsx("div",{className:"flex-1 flex flex-col items-center justify-center min-h-0",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sky font-black text-[10px] md:text-xs uppercase tracking-[0.3em] md:tracking-[0.4em] mb-3 md:mb-4 font-sans",children:"SELECT ALL LAND NEIGHBORS FOR"}),e.jsx("img",{src:`https://flagcdn.com/w160/${te(o.flag)}.png`,alt:`${o.name} Flag`,className:"h-10 md:h-14 w-auto mx-auto mb-2 md:mb-3 drop-shadow-lg object-contain"}),e.jsx("h3",{className:"text-2xl md:text-3xl font-display font-black text-white leading-tight px-4 uppercase tracking-tighter drop-shadow-lg",children:o.name})]})}),e.jsx("div",{className:"shrink-0 px-1 pb-2",children:e.jsx("div",{className:"grid grid-cols-3 gap-1.5 md:gap-2 w-full",children:G.map(t=>{var p;const s=g.includes(t),i=(p=o.borders)==null?void 0:p.includes(t),c=s&&!i;let r="bg-white/5 border border-white/30 text-white/70 active:bg-white/10 active:border-sky/40 shadow-inner";return d?i&&s?r="bg-accent/70 border-accent text-white":i&&!s?r="bg-warning/40 border-warning text-white":s&&!i?r="bg-red-500/70 border-red-500 text-white":r="bg-white/5 border-white/5 text-white/10 opacity-40 grayscale blur-[1px]":s&&(r="bg-sky/60 border-sky text-white shadow-[inset_0_0_12px_rgba(56,189,248,0.3)]"),e.jsx("button",{onClick:()=>H(t),disabled:!!d,className:`relative p-2 md:p-2.5 rounded-lg md:rounded-xl font-black text-[9px] md:text-[10px] flex items-center justify-center min-h-[44px] md:min-h-[48px] text-center transition-all duration-500 uppercase tracking-tight overflow-hidden group ${r} ${d&&c?"animate-shake":""}`,style:{WebkitTapHighlightColor:"transparent"},children:e.jsx("span",{className:"leading-tight line-clamp-2 relative z-10 drop-shadow-md",children:t})},t)})})}),e.jsxs("div",{className:"shrink-0 relative z-10 pt-2",children:[e.jsx("div",{className:"h-px w-full bg-white/10 mb-2"}),d?e.jsx("div",{className:`p-3 rounded-xl border flex items-center justify-center gap-3 font-black uppercase tracking-widest relative overflow-hidden animate-in zoom-in-95 duration-300 ${d==="correct"?"bg-accent/60 border-accent text-white":"bg-red-500/60 border-red-500 text-white"}`,children:e.jsx("span",{className:"text-sm relative z-10 drop-shadow-md",children:D})}):e.jsx(k,{onClick:U,disabled:g.length===0,className:"w-full h-10 md:h-11 text-xs md:text-sm uppercase tracking-widest",size:"lg",children:"Submit"})]})]},o.id)})]}),e.jsx(Q,{type:d,triggerKey:B})]},"playing"),l==="finished"&&e.jsx(f.div,{initial:{opacity:0,scale:1.1},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"h-full flex items-center justify-center px-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white/10 backdrop-blur-3xl rounded-3xl p-10 text-center border-2 border-white/40 relative z-10 overflow-hidden",children:[e.jsx("div",{className:"w-20 h-20 bg-warning/20 rounded-full flex items-center justify-center mx-auto mb-8 text-warning border border-white/30 relative overflow-hidden",children:e.jsx(P,{size:36,className:"relative z-10"})}),e.jsx("h1",{className:"text-3xl font-display font-black text-white mb-1 uppercase tracking-tighter drop-shadow-md",children:"Finished"}),e.jsx("p",{className:"text-white/40 mb-6 text-[10px] font-bold uppercase tracking-[0.2em] drop-shadow-sm",children:"Final Score"}),e.jsx("div",{className:"text-7xl font-display font-black text-white mb-10 tabular-nums",children:x}),e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx(k,{onClick:R,size:"md",className:"w-full h-16 text-xl uppercase tracking-widest font-black",children:"Play Again"}),e.jsxs("button",{onClick:()=>A("/games"),className:"inline-flex items-center justify-center gap-2 text-white/30 hover:text-white transition-all font-black uppercase tracking-[0.3em] text-[10px] group relative z-20 pointer-events-auto",children:[e.jsx(y,{size:14,className:"group-hover:-translate-x-1 transition-transform"}),"Back to Games"]})]})]})},"finished")]})})}export{me as default};
